// Retro Text Component
// Usage: {{ retro_text(text="Hello", tag="h1", size="5rem", font="Arial, sans-serif") }}

// CSS Property for wave animation
@property --wave-amplitude {
  syntax: "<length>";
  initial-value: -3px;
  inherits: true;
}

.retro-word {
  display: inline-flex;
  font-family: var(--retro-text-font, "Bytesized", monospace);
  font-size: var(--retro-text-size, 5rem);
  margin-bottom: 0;
  line-height: 1;
  cursor: default;

  text-decoration: none !important;
  border: none !important;
  outline: none !important;

  /* Optimized: Using filter only for the outer white border unification */
  filter: 
    drop-shadow(2px 0 0 white) 
    drop-shadow(-2px 0 0 white) 
    drop-shadow(0 2px 0 white) 
    drop-shadow(0 -2px 0 white);

  transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);

  &:hover {
    transform: scale(1.1);
  }
}

.retro-letter {
  position: relative;
  color: transparent;
  z-index: 1;
  display: inline-block;
  
  --wave-amplitude: -3px;

  transition: --wave-amplitude 0.5s ease;

  animation: retro-wave 1s ease-in-out infinite running;
  animation-delay: calc(0.1s * var(--i));

  &::after {
    /* Layer 2 (Top): The Fill */
    content: attr(data-text);
    position: absolute;
    left: 0;
    top: 0;
    z-index: 10;

    // Use the loop index (--i) to shift the background, creating a continuous/randomized look
    // Layering: Image on top, Solid color behind
    background:
      url("/images/retro-boil.svg") calc(var(--i) * 50px) center / auto 100%
        repeat-x,
      #db4740;

    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    
    /* Ensure no stroke interferes with the fill */
    -webkit-text-stroke: 0;
  }

  &::before {
    /* Layer 2 (Middle): Black Border + Projected Shadow */
    content: attr(data-text);
    position: absolute;
    left: 0;
    top: 0;
    z-index: 5; /* Above base layer (white stroke), below fill (z-10) */
    
    color: transparent;
    -webkit-text-stroke: 8px black;

    /* Optimized shadow: thickened to match stroke width */
    text-shadow: 
      0 12px 0 #000,
      4px 12px 0 #000,
      -4px 12px 0 #000;
  }
}

@keyframes retro-wave {
  0%,
  100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(var(--wave-amplitude));
  }
}
